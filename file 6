#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct Hostel {
    int sid; char name[50]; int room; char block[10];
    struct Hostel *next;
} Hostel;

Hostel* add_allot(Hostel *h,int sid,char *name,int room,char *block){
    Hostel *n=malloc(sizeof(Hostel)); n->sid=sid; strcpy(n->name,name); n->room=room; strcpy(n->block,block); n->next=NULL;
    if(!h) return n;
    Hostel *t=h; while(t->next) t=t->next; t->next=n; return h;
}
Hostel* remove_student(Hostel *h,int sid){
    Hostel *t=h,*prev=NULL;
    while(t && t->sid!=sid){ prev=t; t=t->next; }
    if(!t){ printf("Not found\n"); return h; }
    if(!prev){ h=h->next; free(t);} else { prev->next=t->next; free(t); } printf("Removed\n"); return h;
}
Hostel* search_by_room(Hostel *h,int room){
    while(h){ if(h->room==room) return h; h=h->next; } return NULL;
}
Hostel* search_by_name(Hostel *h,char *name){
    while(h){ if(strcmp(h->name,name)==0) return h; h=h->next; } return NULL;
}
void display_block(Hostel *h,char *block){ while(h){ if(strcmp(h->block,block)==0) printf("%d %s %d %s\n",h->sid,h->name,h->room,h->block); h=h->next; } }
void reverse_display(Hostel *h){ if(!h) return; reverse_display(h->next); printf("%d %s %d %s\n",h->sid,h->name,h->room,h->block); }
int count_block(Hostel *h,char *block){ int c=0; while(h){ if(strcmp(h->block,block)==0) c++; h=h->next; } return c; }

int main(){
    Hostel *h=NULL; int ch;
    while(1){
        printf("\n1.Add 2.Remove 3.Search room 4.Search name 5.Display block 6.Count block 7.Reverse 8.Exit\nChoice: "); if(scanf("%d",&ch)!=1) break;
        if(ch==1){ int sid,room; char name[50],block[10]; printf("sid name room block: "); scanf("%d %49s %d %9s",&sid,name,&room,block); h=add_allot(h,sid,name,room,block); }
        else if(ch==2){ int sid; printf("sid: "); scanf("%d",&sid); h=remove_student(h,sid); }
        else if(ch==3){ int room; printf("room: "); scanf("%d",&room); Hostel *res=search_by_room(h,room); if(res) printf("%d %s %d %s\n",res->sid,res->name,res->room,res->block); else printf("Not found\n"); }
        else if(ch==4){ char name[50]; printf("name: "); scanf("%49s",name); Hostel *res=search_by_name(h,name); if(res) printf("%d %s %d %s\n",res->sid,res->name,res->room,res->block); else printf("Not found\n"); }
        else if(ch==5){ char block[10]; printf("block: "); scanf("%9s",block); display_block(h,block); }
        else if(ch==6){ char block[10]; printf("block: "); scanf("%9s",block); printf("Count: %d\n", count_block(h,block)); }
        else if(ch==7) reverse_display(h);
        else break;
    }
    return 0;
}
